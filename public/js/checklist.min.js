var clientId="",defaultChecklistArray=[],typeChecklistArray=["Agrupamento","Texto","Upload","Multiplas Escolhas","Dupla Escolha","Numerica","Data","Agrupamento (dupla escolha)"],idIncrement=0,allCloneChecklistGrouping=[],checklistText=ONE_ELEMENT(".checklist"),checklistMultipleChoice=ONE_ELEMENT(".checklistMultiple"),checklistOption=ONE_ELEMENT(".checklistOption"),checklistJson=ONE_ELEMENT("#checklistArrayJson").value;function verifyInProgressChecklist(){""!=checklistJson&&(idIncrement=parseInt(ONE_ELEMENT("#lastIdIncrement").value),defaultChecklistArray=JSON.parse(ONE_ELEMENT("#checklistArrayJson").value),allCloneChecklistGrouping=JSON.parse(ONE_ELEMENT("#groupingArrayJson").value),clientId=ONE_ELEMENT("#idClientToJson").value,ONE_ELEMENT("#idClient").value=clientId,ONE_ELEMENT("#cardContentChecklist").style.display="flex",fillChecklistInfo(defaultChecklistArray),verifyBtnScroll())}async function requestDefaultChecklist(e){const t=await fetch(BASE_URL+"/get_default_checklist_request/"+e),i=await t.json();ONE_ELEMENT("#card-loading").style.display="none",ONE_ELEMENT("#cardContentChecklist").style.display="flex",fillChecklistInfo(i),verifyBtnScroll()}function fillChecklistInfo(e){idIncrement=filterDefaultChecklistLastId((defaultChecklistArray=e).subchecklist);let t=ONE_ELEMENT("#cardContentChecklist");t.querySelector("#contentChecklist").innerHTML="",t.querySelector(".defaultChecklist__name").innerHTML="Nome Checklist: "+defaultChecklistArray.name,t.querySelector(".defaultChecklist__points").innerHTML="Pontuação Total: "+defaultChecklistArray.points.toFixed(2),t.querySelector(".defaultChecklist__possiblePoints").innerHTML="Pontuação Obtida: "+defaultChecklistArray.pointsObtained.toFixed(2),t.querySelector(".defaultChecklist__observation").innerHTML="Observação : \n        "+(""!==defaultChecklistArray.observation?defaultChecklistArray.observation:"Não Informado"),fillChecklistsLayout(defaultChecklistArray.subchecklist),fillValuesToChecklist(defaultChecklistArray.subchecklist),eventsChecklists(),updateChecklistPoint()}verifyInProgressChecklist(),[...ALL_ELEMENTS(".defaultCheckRadio")].forEach(e=>{e.addEventListener("change",e=>{let t=e.currentTarget.value;ONE_ELEMENT("#idDefaultChecklist").value=t,ONE_ELEMENT("#cardContentChecklist").style.display="none",LOADING_ELEMENT.style.display="flex",ONE_ELEMENT("#card-loading").append(LOADING_ELEMENT),ONE_ELEMENT("#card-loading").style.display="flex",requestDefaultChecklist(t)})}),[...ALL_ELEMENTS(".clientRadio")].forEach(e=>{e.addEventListener("change",e=>{clientId=e.currentTarget.value,ONE_ELEMENT("#idClient").value=clientId,ONE_ELEMENT("#idClientToJson").value=clientId})}),ONE_ELEMENT(".btnScrollToBotttom").addEventListener("click",()=>{let e=ONE_ELEMENT("#btnSave").getBoundingClientRect();window.scrollBy(e.x,e.y)});const LOW=1,MIDDLE=2,HIGH=3;function updateChecklistPoint(){let e=defaultChecklistArray.points.toFixed(2),t=defaultChecklistArray.pointsObtained.toFixed(2);ONE_ELEMENT(".checklists__point").style.display="flex",ONE_ELEMENT(".checklist__pointTotal").innerHTML=e,ONE_ELEMENT(".checklist__pointObtained").innerHTML=t,updateLayoutSituation(e/3,t)}function updateLayoutSituation(e,t){let i=verifySituationPointsClient(e,t),l=ALL_ELEMENTS(".checklists__point-slot")[1];clearLayoutSituation(),1===i?l.classList.add("low"):2===i?l.classList.add("middle"):l.classList.add("high")}function verifyBtnScroll(){ONE_ELEMENT(".actionsScroll").style.display=defaultChecklistArray!==[]?"flex":"none"}function clearLayoutSituation(){let e=ALL_ELEMENTS(".checklists__point-slot")[1];e.classList.remove("low"),e.classList.remove("middle"),e.classList.remove("high")}function verifySituationPointsClient(e,t){let i=2*e;return t>=0&&t<i?1:t>=i&&t<3*e?2:3}function fillChecklistsLayout(e,t=null){e.forEach(e=>{if(null===t?ONE_ELEMENT("#contentChecklist").append(returnElementChecklist(e)):t.querySelector(".checklist__container").append(returnElementChecklist(e)),e.subchecklist.length>0){let t=ONE_ELEMENT("#checklist"+e.id);fillChecklistsLayout(e.subchecklist,t)}})}function fillValuesToChecklist(e){e.forEach(e=>{let t=ONE_ELEMENT("#checklist"+e.id),i="",l=parseInt(e.id_type_checklist);if(3!==l&&4!==l?1===l?i=t.querySelector(".inputText"):2===l?i=t.querySelector(".inputFile"):5===l?i=t.querySelector(".inputNumber"):6===l&&(i=t.querySelector(".inputDate")):e.options.forEach(e=>{e.selected&&(t.querySelector(".option"+e.id).checked=!0)}),2===l){if(""!==e.value){let i=t.querySelector(".checklist__title").innerHTML,l=e.value.split(",").length;t.querySelector(".checklist__title").innerHTML=`${i}: ${l} arquivo/s selecionado/s`}}else i.value=e.value;if(t.querySelector(".inputObservation").value=e.oficialObservation,t.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+e.pointsObtained.toFixed(2),e.duplicate&&7!==e.id_type_checklist&&(t.querySelector(".checklist__header__actions").style.display="flex",t.querySelector(".checklist__header--optionsContainer").style.display="none",t.querySelector(".checklist__header .btnAdd").classList.remove("d-none")),e.duplicate)if(7===e.id_type_checklist){let i=t.querySelectorAll("input[name=checkGroupingChoice"+e.id),l=allCloneChecklistGrouping.findIndex(t=>{if(t.id===e.idReferenceClone)return!0});e.groupingDoubleChoice&&(i[0].checked=!0,t.style.height="auto"),-1!==l&&(i[0].checked=!0,e.duplicate&&e.subchecklist.forEach(e=>{ONE_ELEMENT("#checklist"+e.id).querySelector(".checklist__header__actions").style.display="flex",ONE_ELEMENT("#checklist"+e.id).querySelector(".checklist__header--optionsContainer").style.display="none",ONE_ELEMENT("#checklist"+e.id).querySelector(".btnDelete").classList.remove("d-none")})),0===e.subchecklist.length&&(i[1].checked=!0,t.style.height="120px",t.querySelectorAll(".checklist__header__slot")[2].classList.add("d-none"),t.querySelector(".checklist__header .btnAdd").classList.add("d-none"))}else{let i=allCloneChecklistGrouping.findIndex(t=>{if(t.id===e.idReferenceClone)return!0});t.style.height=-1!=i?"auto":"120px"}e.subchecklist.length>0&&fillValuesToChecklist(e.subchecklist)})}function returnElementChecklist(e){let t=e.id_type_checklist,i="";return i=3!==t&&4!==t?elementInputsChecklist(e,t):elementMultipleChoiceChecklist(e,t),i}function elementInputsChecklist(e,t){let i=checklistText.cloneNode(!0);return getOrShowInputByType(i,t),fillLayoutChecklist(i,e),i}function elementMultipleChoiceChecklist(e){let t=checklistMultipleChoice.cloneNode(!0);return fillLayoutChecklist(t,e),fillLayoutOptions(e,t),t}function fillLayoutChecklist(e,t){if(e.style.display="flex",e.setAttribute("idchecklist",t.id),e.setAttribute("id","checklist"+t.id),0!==t.id_type_checklist&&7!==t.id_type_checklist||(e.querySelectorAll(".checklist__slot")[0].style.display="none"),7===t.id_type_checklist){e.querySelector(".checklist__header__actions").style.display="flex";let i=e.querySelectorAll(".checkGroupingChoice");i[0].setAttribute("name","checkGroupingChoice"+t.id),i[1].setAttribute("name","checkGroupingChoice"+t.id),-1!==allCloneChecklistGrouping.findIndex(e=>{if(e.id===t.idReferenceClone)return!0})?(i[0].checked=!0,e.querySelectorAll(".checklist__header__slot")[2].classList.remove("d-none"),e.querySelector(".checklist__header__quantity").innerHTML=t.subchecklist.length,e.querySelector(".checklist__header .btnAdd").classList.remove("d-none")):(i[1].checked=!0,e.style.height="120px",e.querySelectorAll(".checklist__header__slot")[2].classList.add("d-none")),t.duplicate||0!==t.pointsObtained&&(i[0].checked=!0,e.style.height="auto",e.querySelector(".checklist__header__quantity").style.display="none",e.querySelectorAll(".checklist__header__slot")[2].classList.remove("d-none")),0===t.subchecklist.length&&(i[1].checked=!0,e.style.height="120px",e.querySelectorAll(".checklist__header__slot")[2].classList.add("d-none"))}t.duplicateSubchecklist&&(e.querySelector(".checklist__header--optionsContainer").style.display="none",e.querySelector(".checklist__header__actions").style.display="flex",e.querySelector(".checklist__header__actions .btnDelete").classList.remove("d-none")),3===t.id_type_checklist||4===t.id_type_checklist?(e.querySelector(".checklistTitleSlot").innerHTML=t.name,e.querySelector(".checklistTitleSlot").setAttribute("title",t.name)):(e.querySelector(".checklist__title").innerHTML=t.name,e.querySelector(".checklist__title").setAttribute("title",t.name));(t.only_one_choose_points||t.only_one_choose)&&(only_one_choose_points="(Pontuação única)*",e.querySelector(".checklistTypechecklist").style="flex:2;"),e.querySelector(".checklistTypechecklist").innerHTML=typeChecklistArray[t.id_type_checklist]+" ",e.querySelector(".checklistTypechecklist").setAttribute("title",""+typeChecklistArray[t.id_type_checklist]),e.querySelector(".checklistPossiblePoints").innerHTML="Pontos: "+t.points.toFixed(2),e.querySelector(".checklistPossiblePoints").setAttribute("title",t.points.toFixed(2)),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2),e.querySelector(".checklistPoints").setAttribute("title",t.pointsObtained.toFixed(2)),""!==t.observation&&(3!==t.id_type_checklist&&4!==t.id_type_checklist?(e.querySelector(".observationIcon").style.display="block",e.querySelector(".observationIcon").setAttribute("title",t.observation)):(e.querySelector(".observationIconMultiple").style.display="block",e.querySelector(".observationIconMultiple").setAttribute("title",t.observation)))}function fillLayoutOptions(e,t){e.options.forEach(i=>{let l=checklistOption.cloneNode(!0);0===i.pointsObtained&&(i.pointsObtained=0),3===e.id_type_checklist?e.only_one_choose?(l.querySelector(".checklistOptionRadio").style.display="flex",l.querySelector(".checklistOptionRadio").setAttribute("name","option"+e.id),l.querySelector(".checklistOptionRadio").classList.add("option"+i.id)):(l.querySelector(".checklistOptionCheck").style.display="flex",l.querySelector(".checklistOptionCheck").setAttribute("name","option"+e.id),l.querySelector(".checklistOptionCheck").classList.add("option"+i.id)):(l.querySelector(".checklistOptionRadio").style.display="flex",l.querySelector(".checklistOptionRadio").setAttribute("name","option"+e.id),l.querySelector(".checklistOptionRadio").classList.add("option"+i.id)),l.style.display="flex",l.setAttribute("idoption",i.id),l.querySelector(".optionName").innerHTML=i.name,l.querySelector(".checklistPoints").innerHTML="Pontos: "+i.points.toFixed(2),t.querySelector(".checklist__options").append(l)})}function getOrShowInputByType(e,t,i=!0){let l="";if(1===t?l=e.querySelector(".inputText"):2===t?l=e.querySelector(".inputFile"):5===t?l=e.querySelector(".inputNumber"):6===t&&(l=e.querySelector(".inputDate")),0!==t&&7!==t){if(!i)return l;l.style.display="flex"}}function eventsChecklists(){[...ALL_ELEMENTS("#contentChecklist .checklist")].forEach(e=>{let t=parseInt(e.getAttribute("idchecklist")),i=filterChecklist(defaultChecklistArray.subchecklist,t,{}),l=i.id_type_checklist;if(0!==l&&7!==l&&3!==l&&4!==l)eventsChecklistsTypeInputs(e,i);else if(0!==l&&7!==l){let t=!1;3===l&&(t=!0),eventsChecklistsMultipleOptions(e,i,t)}i.duplicate?(eventsDoubleChoiceGroupingDuplicate(e,i),eventsDoubleAddChoiceGrouping(e,i)):eventsDoubleChoiceGrouping(e,i),eventsObservationInput(e,i),eventsDoubleDeleteChoiceGrouping(e,i)})}function eventsDoubleChoiceGroupingDuplicate(e,t){[...e.querySelectorAll(".checkGroupingChoice")].forEach(i=>{i.addEventListener("change",i=>{let l=i.currentTarget,c=e.querySelector(".checklist__header .btnAdd");if("1"===l.value)addGroupingChecklist(t),c.classList.remove("d-none");else{clearGroupingChecklist(t),clearPointsChecklist(t),c.classList.add("d-none"),setChecklistPoint(t.id);let e=0;t.subchecklist.forEach(t=>{let i=0;setChecklistPoint(t.id),7!==t.id_type_checklist&&0!==t.id_type_checklist||(t.subchecklist.forEach(t=>{i+=t.pointsObtained,e+=t.pointsObtained}),t.pointsObtained=i)}),t.pointsObtained=e;let i=0;defaultChecklistArray.subchecklist.forEach(e=>{i+=e.pointsObtained}),defaultChecklistArray.pointsObtained=i,fillChecklistInfo(defaultChecklistArray)}})})}function eventsDoubleChoiceGrouping(e,t){[...e.querySelectorAll(".checkGroupingChoice")].forEach(i=>{i.addEventListener("change",i=>{"1"===i.currentTarget.value?(e.style.height="auto",t.groupingDoubleChoice=!0):(e.style.height="120px",t.groupingDoubleChoice=!1,clearPointsChecklist(t),fillChecklistInfo(defaultChecklistArray))})})}function clearPointsChecklist(e){e.idDefaultChecklist===defaultChecklistArray.id&&(defaultChecklistArray.pointsObtained=defaultChecklistArray.pointsObtained-e.pointsObtained),e.pointsObtained=0,e.subchecklist.forEach(e=>{e.pointsObtained=0,e.value="",e.oficialObservation="",e.options.length>0&&e.options.forEach(e=>{e.selected=!1}),e.subchecklist.length>0&&e.subchecklist.forEach(e=>{clearPointsChecklist(e)})})}function eventsDoubleAddChoiceGrouping(e,t){let i=e.querySelector(".checklist__header .btnAdd");null!==i&&i.addEventListener("click",e=>{let i=t.idReferenceClone,l=allCloneChecklistGrouping.findIndex(e=>{if(e.id===i)return!0});if(allCloneChecklistGrouping.length>0&&-1!==l){let e=JSON.parse(JSON.stringify(allCloneChecklistGrouping[l]));idIncrement+=1,newIdCheck=idIncrement,e.id=idIncrement,e.id_type_checklist=0,e.duplicate=!1,e.duplicateSubchecklist=!0,t.subchecklist.push(e),updateIncrementChecklist(t),setChecklistPoint(t.id);let i=0;t.subchecklist.forEach(e=>{let t=0;setChecklistPoint(e.id),7!==e.id_type_checklist&&0!==e.id_type_checklist||(e.subchecklist.forEach(e=>{t+=e.pointsObtained,i+=e.pointsObtained,setChecklistPoint(e.id)}),e.pointsObtained=t)}),t.pointsObtained=i,updatePointsFatherChecklist(t,i,!1);let c=0;console.log(defaultChecklistArray.subchecklist),defaultChecklistArray.subchecklist.forEach(e=>{c+=e.pointsObtained}),defaultChecklistArray.pointsObtained=c,fillChecklistInfo(defaultChecklistArray)}else addGroupingChecklist(t)})}function eventsDoubleDeleteChoiceGrouping(e,t){let i=e.querySelector(".checklist__header .btnDelete");null!==i&&i.addEventListener("click",e=>{let i=filterChecklist(defaultChecklistArray.subchecklist,t.idDefaultChecklist,{});i.subchecklist.length>1?i.subchecklist.forEach(e=>{if(e.id===t.id){let t=i.subchecklist.findIndex(t=>{if(t.id===e.id)return!0});i.subchecklist.splice(t,1)}}):clearGroupingChecklist(i),setChecklistPoint(i.id);let l=0,c=0;i.subchecklist.forEach(e=>{let t=0;setChecklistPoint(e.id),7!==e.id_type_checklist&&0!==e.id_type_checklist||(e.subchecklist.forEach(e=>{t+=e.pointsObtained,c+=e.pointsObtained}),e.pointsObtained=t)}),i.pointsObtained=c,defaultChecklistArray.subchecklist.forEach(e=>{l+=e.pointsObtained}),defaultChecklistArray.pointsObtained=l,updateIncrementChecklist(i),fillChecklistInfo(defaultChecklistArray)})}function addGroupingChecklist(e){let t={...e},i=JSON.parse(JSON.stringify(e));allCloneChecklistGrouping.push(i),e.subchecklist=[],idIncrement+=1,t.id=idIncrement,t.id_type_checklist=0,t.idDefaultChecklist=e.id,t.duplicateSubchecklist=!0,t.duplicate=!1,e.idReferenceClone=i.id,e.subchecklist.push(t),updateIncrementChecklist(t),setChecklistPoint(t.id),fillChecklistInfo(defaultChecklistArray,!0),ONE_ELEMENT("#checklist"+t.id).querySelector(".btnDelete").classList.remove("d-none")}function clearGroupingChecklist(e){let t=e;t.subchecklist=[],t.oficialObservation="";let i=allCloneChecklistGrouping.findIndex(e=>{if(e.id===t.idReferenceClone)return!0});allCloneChecklistGrouping[i].subchecklist.forEach(t=>{let i=JSON.parse(JSON.stringify(t));e.subchecklist.push(i)}),allCloneChecklistGrouping.splice(i,1),updateIncrementChecklist(e),e.subchecklist.forEach(e=>{setChecklistPoint(e.id)}),fillChecklistInfo(defaultChecklistArray)}function updateIncrementChecklist(e){e.subchecklist.forEach((t,i)=>{let l=JSON.parse(JSON.stringify(t.subchecklist));if(0===t.id_type_checklist&&t.duplicateSubchecklist){let e=t.name.split("-");t.name=e[0]+" - "+(i+1)}t.subchecklist=[],t.idDefaultChecklist=e.id,l.length>0&&l.forEach(e=>{let i=JSON.parse(JSON.stringify(e));if(idIncrement+=1,i.id=idIncrement,i.idDefaultChecklist=t.id,i.options.length>0){let e=JSON.parse(JSON.stringify(i.options));i.options=[],e.forEach(e=>{let t=JSON.parse(JSON.stringify(e));idIncrement+=1,t.id=idIncrement,i.options.push(t)})}i.subchecklist.length>0&&updateIncrementChecklist(i),t.subchecklist.push(i)})})}function setChecklistPoint(e){let t=filterChecklist(defaultChecklistArray.subchecklist,e,{}),i=t.points,l=filterChecklist(defaultChecklistArray.subchecklist,e,{}).subchecklist,c=i/l.length,s=c/i*100;0!==t.pointsObtained&&(t.pointsObtained=c),l.forEach(e=>{if(0!=e.pointsObtained&&7!==e.id_type_checklist&&0!==e.id_type_checklist&&(e.pointsObtained=c),e.points=c,e.percentage=s,e.correctPercentage=!0,e.options.length>0&&updatePointsOptions(e.options,e.points,e),0!=e.pointsObtained&&3===e.id_type_checklist){let t=0;e.options.forEach(e=>{e.selected&&(t+=e.points)}),e.pointsObtained=t}let t=e.subchecklist.length;if(t>0){let i=e.points/t,l=i/e.points*100;e.subchecklist.forEach(e=>{e.points=i,e.percentage=l,setChecklistPoint(e.id)})}})}function updatePointsOptions(e,t,i){let l=i.id_type_checklist,c=i.only_one_choose_points,s=i.only_one_choose,n=e.length,o=t/n,r=o/t*100;e.forEach(e=>{"4"===l?e.selected?e.points=o:e.points=0:c||s?(c||s)&&(e.points=t):(e.points=o,e.percentage=r,e.correctPercentage=!0)})}function eventsChecklistsTypeInputs(e,t){let i=t.id_type_checklist,l=getOrShowInputByType(e,i,!1);2===i?l.addEventListener("change",i=>{let l=t.points,c=i.currentTarget.files;e.querySelector(".alert").classList.add("d-none");let s=0;[...c].forEach(e=>{s+=e.size}),s<4e7?uploadFile(c,t):(e.querySelector(".alert").classList.remove("d-none"),e.querySelector(".alert").innerHTML="O arquivo tem que ser menor que 40mb"),t.pointsObtained=l,e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2),""===t.value&&updatePointsFatherChecklist(t,l)}):l.addEventListener("input",i=>{let l=t.points,c=i.currentTarget.value,s=!0;""!==c?t.pointsObtained=l:(s=!1,t.pointsObtained=0),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2),""===t.value&&updatePointsFatherChecklist(t,l,s),!1===s&&updatePointsFatherChecklist(t,l,s),t.value=c})}function eventsObservationInput(e,t){e.querySelector(".inputObservation").addEventListener("keyup",e=>{let i=e.currentTarget.value;t.oficialObservation=i})}async function uploadFile(e,t){let i=ONE_ELEMENT("#uploadFileForm");const l=new FormData(i);[...e].forEach(e=>{l.append("checklistFile[]",e)});const c=await fetch(BASE_URL+"/upload_file",{method:"POST",body:l});let s=(await c.json()).filesNames;t.value=s.join(","),t.files=e}function eventsChecklistsMultipleOptions(e,t,i=!0){[...e.querySelectorAll(".checklistOption")].forEach(l=>{let c=parseInt(l.getAttribute("idoption"));(!1===i||t.only_one_choose?l.querySelector("input[type=radio]"):l.querySelector("input[type=checkbox]")).addEventListener("change",l=>{let s=t.options.findIndex(e=>{if(e.id===c)return!0}),n=t.options[s],o=n.points,r=t.pointsObtained;if(l.currentTarget.checked){t.pointsObtained=r+o,(t.only_one_choose||t.only_one_choose_points)&&t.options.forEach(e=>{e.pointsObtained=0});let l=0;n.selected=!0,n.pointsObtained=o;let c=!0;t.options.forEach(e=>{e.selected&&l++}),l>2&&t.only_one_choose&&(t.options.forEach(e=>{e.selected=!1}),n.selected=!0),0===o&&(c=!1,o=t.points),(t.only_one_choose||t.only_one_choose_points)&&(t.pointsObtained=o),!1===i&&(t.pointsObtained=o,!1===c&&(t.pointsObtained=0,1===l&&(o=0))),t.only_one_choose&&l>1&&(o=0,t.options.forEach(e=>{e.selected=!1}),n.selected=!0),updatePointsFatherChecklist(t,o,c),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2)}else if(t.pointsObtained=r-o,n.selected=!1,!1===i&&(t.pointsObtained=o),t.only_one_choose||t.only_one_choose_points){let i=0;t.options.forEach(e=>{e.selected&&i++}),0===i?(t.pointsObtained=0,updatePointsFatherChecklist(t,o,!1),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2)):(t.pointsObtained=o,updatePointsFatherChecklist(t,o,!1),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2))}else n.pointsObtained=0,updatePointsFatherChecklist(t,o,!1),e.querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+t.pointsObtained.toFixed(2)})})}function updatePointsFatherChecklist(e,t,i=!0){let l=e.idDefaultChecklist;if(l===defaultChecklistArray.id){updateLayoutChecklistMaster(updatePointsChecklistMaster(defaultChecklistArray.subchecklist,0))}else{let e=filterChecklist(defaultChecklistArray.subchecklist,l,{});null!==e&&(i&&(e.pointsObtained+=t),!1===i&&e.pointsObtained>0&&(e.pointsObtained-=t),updateLayoutChecklist(e),null!==e.idDefaultChecklist&&updatePointsFatherChecklist(e,t,i)),updateLayoutChecklistMaster(updatePointsChecklistMaster(defaultChecklistArray.subchecklist,0))}}function updatePointsChecklistMaster(e,t=0){let i=t;return e.forEach(e=>{e.idDefaultChecklist===defaultChecklistArray.id&&(i+=e.pointsObtained,e.subchecklist.length>0&&(i=updatePointsChecklistMaster(e.subchecklist,i)))}),i}function updateLayoutChecklistMaster(e){defaultChecklistArray.pointsObtained=e,ONE_ELEMENT("#cardContentChecklist").querySelector(".defaultChecklist__possiblePoints").innerHTML="Pontuação Obtida: "+defaultChecklistArray.pointsObtained.toFixed(2),updateChecklistPoint()}function updateLayoutChecklist(e){ONE_ELEMENT("#checklist"+e.id).querySelector(".checklistPoints").innerHTML="Pontos Obtidos: "+e.pointsObtained.toFixed(2)}function filterChecklist(e,t,i){let l=i;return t!==defaultChecklistArray.id?e.forEach(e=>{e.id===t?l=e:e.subchecklist!=[]&&(l=filterChecklist(e.subchecklist,t,l))}):l=null,l}function filterDefaultChecklistLastId(e,t=0){let i=t;return e.forEach(e=>{e.id>i&&(i=e.id),e.subchecklist.length>0&&(i=filterDefaultChecklistLastId(e.subchecklist,i))}),i}function verifyEmptyClient(){return""===clientId&&(ONE_ELEMENT(".alert-header").classList.remove("d-none"),ONE_ELEMENT(".alert-header").querySelector(".alert").innerHTML="Selecione um cliente",!0)}function verifyEmptyDefaultChecklist(){return 0===defaultChecklistArray.length&&(ONE_ELEMENT(".alert-header").classlist.remove("d-none"),ONE_ELEMENT(".alert-header").querySelector(".alert").innerHTML="Selecione uma checklist padrão",!0)}ONE_ELEMENT("#btnFinish").addEventListener("click",()=>{verifyEmptyClient()||verifyEmptyDefaultChecklist()?window.scrollTo(0,0):(ONE_ELEMENT("#checklistArray").value=JSON.stringify(defaultChecklistArray),ONE_ELEMENT("#formChecklistAdd").submit())}),ONE_ELEMENT("#btnSave").addEventListener("click",()=>{verifyEmptyClient()||verifyEmptyDefaultChecklist()?window.scrollTo(0,0):(ONE_ELEMENT("#idChecklist").value=defaultChecklistArray.id,ONE_ELEMENT("#checklistArrayJson").value=JSON.stringify(defaultChecklistArray),ONE_ELEMENT("#groupingArrayJson").value=JSON.stringify(allCloneChecklistGrouping),ONE_ELEMENT("#checklist_name").value=defaultChecklistArray.name,ONE_ELEMENT("#lastIdIncrement").value=idIncrement,ONE_ELEMENT("#formChecklistAddJson").submit())});