var checklist=ONE_ELEMENT(".checklistExibition"),checklistArray=JSON.parse(ONE_ELEMENT("#checklistArray").value),typeChecklistArray=["Agrupamento","Texto","Upload","Multiplas Escolhas","Dupla Escolha","Numerica","Data","Agrupamento (dupla escolha)","Maior/Igual Que","Menor/Igual Que"],optionsChecklist=ONE_ELEMENT(".optionsChecklistExibition"),downloadChecklistItem=ONE_ELEMENT(".download__item"),formChecklist=ONE_ELEMENT("#formChecklistExibition"),carrousel=ONE_ELEMENT("#carousel"),idDefaultChecklist=parseInt(ONE_ELEMENT("#defaultChecklistId").value);function showChecklist(e,t=null){e.map(e=>{let i=checklist.cloneNode(!0);i.style.display="flex",0!==e.id_type_checklist&&3!==e.id_type_checklist&&4!==e.id_type_checklist||i.querySelector(".checklist__slot--value").remove(),fillInputsAndAttributeChecklist(i,e),appendChecklist(i,t),appendOptions(e,i),repeatLoopShowChecklist(e,i),i.querySelector(".btnSeeMoreCheck").setAttribute("id",e.id)})}function fillInputsAndAttributeChecklist(e,t){if(e.setAttribute("idElement",t.id),e.setAttribute("id","check"+t.id),e.style.height="100px",e.querySelector(".checklist__title").innerHTML=t.name,e.querySelector(".checklist__title").setAttribute("title",t.name),2===t.id_type_checklist)t.file_name.length>0?(e.style.height="auto",fillPicturesAndDocumentsModal(e,t.file_name)):(e.querySelector(".valueChecklist").classList.remove("d-none"),e.querySelector(".valueChecklist").innerHTML="Nenhum arquivo inserido");else if(0!==t.id_type_checklist&&3!==t.id_type_checklist&&4!==t.id_type_checklist&&7!==t.id_type_checklist){e.querySelector(".valueChecklist").classList.remove("d-none");let i="Nenhum Valor Inserido";""!==t.value&&(i=t.value),e.querySelector(".valueChecklist").innerHTML=i}else if(""===t.value){let t=e.querySelector(".checklist__slot--value");null!==t&&(t.style.display="none")}e.querySelector(".points").innerHTML="Pontos Possiveis: "+t.points.toFixed(2),e.querySelector(".points").setAttribute("title",t.points),e.querySelector(".pointsObtained").innerHTML="Pontos Obtidos: "+t.pointsObtained,e.querySelector(".pointsObtained").setAttribute("title",t.pointsObtained),e.querySelector(".observation").innerHTML=""===t.observation?"Nenhuma observação":t.observation,e.querySelector(".observation").setAttribute("title",t.observation)}function fillPicturesAndDocumentsModal(e,t){let i=e.querySelector(".picturesCarrousel");i.style.display="flex";let l=i.querySelectorAll(".picture")[0].cloneNode(!0);i.innerHTML="",t.forEach((e,t)=>{let s=l.cloneNode(!0),c=s.querySelector("img");verifyImgs(e)?(s.setAttribute("href",`${BASE_URL}/storage/checklists_files/${e}`),c.setAttribute("src",`${BASE_URL}/storage/checklists_files/${e}`)):(c.setAttribute("src",BASE_URL+"/storage/general_icons/file.png"),s.setAttribute("href",`${BASE_URL}/storage/general_icons/${e}`)),s.setAttribute("key",t),i.append(s)}),eventPictureShowModal(i,t)}function eventPictureShowModal(e,t){[...e.querySelectorAll(".picture")].forEach(e=>{e.addEventListener("click",e=>{let i=parseInt(e.currentTarget.getAttribute("key"));openModalFiles(t,i)})})}function openModalFiles(e,t){ONE_ELEMENT("#modalActions").querySelector(".modal-body").innerHTML="",ONE_ELEMENT("#modalActions").querySelector(".modal-title").innerHTML="Clique para baixar",ONE_ELEMENT("#btnAddModal").style.display="none",ONE_ELEMENT("#btnEditModal").style.display="none",ONE_ELEMENT("#modalActions .modal-body").append(carrousel);let i=carrousel.querySelector(".carousel-item").cloneNode(!0),l=carrousel.querySelector(".carousel-inner");l.innerHTML="",e.forEach((e,s)=>{let c=i.cloneNode(!0);verifyImgs(e)?(c.querySelector("img").setAttribute("src",`${BASE_URL}/storage/checklists_files/${e}`),c.setAttribute("href",`${BASE_URL}/storage/checklists_files/${e}`)):(c.querySelector("img").setAttribute("src",BASE_URL+"/storage/general_icons/file.png"),c.setAttribute("href",`${BASE_URL}/storage/checklists_files/${e}`)),l.append(c),s===t?c.classList.add("active"):c.classList.remove("active")}),carrousel.classList.remove("d-none")}function verifyImgs(e){let t=e.split(".")[1];return void 0!==["jpg","jpeg","png","gif","svg"].find(e=>e===t)}function appendOptions(e,t){e.options.length>0&&e.options.forEach(e=>{let i=optionsChecklist.cloneNode(!0);i.querySelector(".optionName").innerHTML=e.name,i.querySelector(".optionSelected").innerHTML=e.selected?"Sim":"Não",i.querySelector(".optionPointsObtained").innerHTML=e.pointsObtained,i.querySelector(".optionPoints").innerHTML=e.points,i.style.display="flex",t.style.height="auto",t.querySelector(".checklist__container").append(i)})}function appendChecklist(e,t){null===t?ONE_ELEMENT(".checklistContent").append(e):t.querySelector(".checklist__container").append(e)}function repeatLoopShowChecklist(e,t=null){e.subchecklist.length>0&&(t.querySelector(".btnSeeMore").style.display="block",showChecklist(e.subchecklist,t))}function eventFilesNames(){[...ALL_ELEMENTS(".checklistContent .checklist__download--btn")].forEach(e=>{e.addEventListener("click",e=>{let t=parseInt(e.currentTarget.getAttribute("id"));openModalFiles(filterChecklist(checklistArray.subchecklist,t,{}).file_name)})})}function eventBtnPrint(){ONE_ELEMENT("#btnPrint").addEventListener("click",()=>{[...ALL_ELEMENTS(".checklistContent .btnSeeMore")].forEach(e=>{if("block"===e.style.display){let t=e.closest(".checklistExibition");t.classList.contains("active")||showSubchecklistContainer(t)}}),window.print()})}function eventsBtnSeeMore(){[...ALL_ELEMENTS(".checklistContent .btnSeeMore")].forEach(e=>{e.addEventListener("click",e=>{showSubchecklistContainer(e.currentTarget.closest(".checklistExibition"))})})}function eventsBtnSeeMoreCheck(){[...ALL_ELEMENTS(".checklistContent .btnSeeMoreCheck")].forEach(e=>{e.addEventListener("click",e=>{let t=parseInt(e.currentTarget.getAttribute("id"));openModalChecklist(filterChecklist(checklistArray.subchecklist,t,{}))})})}function openModalChecklist(e){if(ONE_ELEMENT("#modalActions").querySelector(".modal-body").innerHTML="",ONE_ELEMENT("#modalActions").querySelector(".modal-title").innerHTML="Detalhes Checklist",ONE_ELEMENT("#btnAddModal").style.display="none",ONE_ELEMENT("#btnEditModal").style.display="none",formChecklist.querySelector(".nameChecklist").innerHTML=e.name,formChecklist.querySelector(".typeChecklist").innerHTML=typeChecklistArray[e.id_type_checklist],2===e.id_type_checklist){if(formChecklist.querySelector(".valueChecklist").style.display="none",e.file_name.length>0){let t=formChecklist.querySelector(".picturesCarrousel");t.style.display="flex";let i=t.querySelectorAll(".picture")[0].cloneNode(!0);t.innerHTML="",t.style.maxWidth="initial",e.file_name.forEach((l,s)=>{let c=i.cloneNode(!0),o=c.querySelector("img");verifyImgs(l)?(c.setAttribute("href",`${BASE_URL}/storage/checklists_files/${l}`),o.setAttribute("src",`${BASE_URL}/storage/checklists_files/${l}`)):(o.setAttribute("src",BASE_URL+"/storage/general_icons/file.png"),c.setAttribute("href",`${BASE_URL}/storage/general_icons/${l}`)),c.setAttribute("key",s),t.append(c),eventPictureShowModal(t,e.file_name)})}}else 0!==e.id_type_checklist&&3!==e.id_type_checklist&&4!==e.id_type_checklist?(formChecklist.querySelector(".valueChecklist").style.display="flex",formChecklist.querySelector(".valueChecklist").innerHTML=e.value):formChecklist.querySelector(".valueChecklist").closest(".form-group").style.display="none";formChecklist.querySelector(".pointsChecklist").innerHTML="Pontos: "+e.points.toFixed(2),formChecklist.querySelector(".pointsObtainedChecklist").innerHTML="Pontos Obtidos: "+e.pointsObtained.toFixed(2),formChecklist.querySelector(".observationChecklist").innerHTML=""===e.observation?"Nenhuma observação":e.observation,formChecklist.style.display="block",ONE_ELEMENT("#modalActions").querySelector(".modal-body").append(formChecklist)}function showSubchecklistContainer(e){let t=parseInt(e.getAttribute("idElement")),i=filterChecklist(checklistArray.subchecklist,t,{});if(e.classList.contains("active"))e.style.height="100px",e.classList.remove("active"),i.active=!1;else{let t=30*e.querySelector(".checklist__container").children.length,l=100+getTotalHeight(e)+t;if(e.style.height=l+"px",e.classList.add("active"),i.active=!0,null!=i.idChecklist&&i.idChecklist!==idDefaultChecklist){getElementChecklist(filterChecklist(checklistArray.subchecklist,i.idChecklist,{}).id).style.height="auto"}}}function getElementChecklist(e){let t=ONE_ELEMENT(".card-body").querySelectorAll(".checklistExibition"),i="";return[...t].forEach(t=>{let l=parseInt(t.getAttribute("idelement"));e===l&&(i=t)}),i}function getTotalHeight(e){let t=0;return[...e.querySelector(".checklist__container").children].forEach(e=>{let i=e.offsetHeight;t+=i}),t}function showSubchecklistContainerLoop(e){e.forEach(e=>{let t=ONE_ELEMENT("#check"+e.id);if(e.active){let i=t.querySelectorAll(".checklistContent .checklistExibition").length,l=100+100*i+35*i;t.style.height=l+"px",t.classList.add("active"),e.active=!0}else defaultChecklistElement.style.height="65px",defaultChecklistElement.classList.remove("active"),e.active=!1;e.subchecklist.length>0&&showSubchecklistContainerLoop(e.subchecklist)})}function increaseDefaultChecklistFather(e,t=65){let i=ONE_ELEMENT("#check"+e.id),l=i.offsetHeight;if(t>65&&(i.style.height=l+t+"px"),null!=e.idDefaultChecklist){let i=filterChecklist(checklistArray.subchecklist,e.idDefaultChecklist,{}),l=e.subchecklist.length;increaseDefaultChecklistFather(i,65+65*l+35*l+t)}}function filterChecklist(e,t,i){let l=i;return e.forEach(e=>{e.id===t?l=e:e.subchecklist!=[]&&(l=filterChecklist(e.subchecklist,t,l))}),l}showChecklist(checklistArray.subchecklist),eventsBtnSeeMore(),eventsBtnSeeMoreCheck(),eventFilesNames(),eventBtnPrint();